<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini ë²ˆì—­ê¸°</title>
    <style>
        button.mic-button { padding: 10px; font-size: 16px; cursor: pointer; border: none; background-color: #28a745; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-left: 10px; }
        .controls { display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>
    <h1>Gemini ë²ˆì—­ê¸°</h1>
    <textarea id="inputText" placeholder="ë²ˆì—­í•  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”."></textarea>
    <div class="controls">
        <button onclick="startVoiceRecognition()">ğŸ¤</button>
        <button onclick="translateText()">ë²ˆì—­í•˜ê¸°</button>
    </div>
    <div id="result">ë²ˆì—­ ê²°ê³¼</div>

    <script type="module">
  import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

  const API_KEY = "AIzaSyBuxqNb7hMANG1Uj6LPBI2VO_-nhmpmhNo";
  const genAI = new GoogleGenerativeAI(API_KEY);

  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  if (!SpeechRecognition) {
    alert("ì£„ì†¡í•©ë‹ˆë‹¤. ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± ì¸ì‹ ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
  }
  const recognition = new SpeechRecognition();
  recognition.interimResults = false;
  recognition.lang = 'ko-KR';

  // Make functions globally accessible by assigning them to the window object
  window.startVoiceRecognition = function() {
    recognition.start();
    document.getElementById('inputText').value = "ìŒì„± ì…ë ¥ ì¤‘...";
  };

  window.translateText = async function() {
    const inputText = document.getElementById('inputText').value;
    const resultDiv = document.getElementById('result');

    if (!inputText || inputText === "ìŒì„± ì…ë ¥ ì¤‘..." || inputText === "ìŒì„± ì¸ì‹ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.") {
      resultDiv.textContent = "ë²ˆì—­í•  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ê±°ë‚˜ ë§í•´ì£¼ì„¸ìš”.";
      return;
    }

    resultDiv.textContent = "ë²ˆì—­ ì¤‘...";

    try {
      const model = genAI.getGenerativeModel({ model: "gemini-2.0-flash" });
      const prompt = `Translate the following text into Korean: "${inputText}"`;
      const result = await model.generateContent(prompt);
      const response = await result.response;
      const translatedText = response.text();
      resultDiv.textContent = translatedText;
    } catch (error) {
      console.error("ë²ˆì—­ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
      resultDiv.textContent = "ë²ˆì—­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
    }
  };

  recognition.addEventListener('result', (event) => {
    const transcript = event.results[0][0].transcript;
    document.getElementById('inputText').value = transcript;
    window.translateText(); // Call the global function
  });

  recognition.addEventListener('error', (event) => {
    console.error('ìŒì„± ì¸ì‹ ì˜¤ë¥˜:', event.error);
    document.getElementById('inputText').value = "ìŒì„± ì¸ì‹ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";
  });
</script>
</body>
</html>
